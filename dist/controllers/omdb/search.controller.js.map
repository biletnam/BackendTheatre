{"version":3,"sources":["../../../controllers/omdb/search.controller.js"],"names":["reqPro","require","cheerio","searchMovies","req","res","next","url","params","movieName","then","htmlString","result","$","load","searchResults","find","i","length","temp","kimRating","children","data","indexOf","replace","trim","push","json","catch","err","error","module","exports"],"mappings":"AAAA;;;AAGA;;AACA,IAAMA,SAASC,QAAQ,iBAAR,CAAf;AACA,IAAMC,UAAUD,QAAQ,SAAR,CAAhB;;AAEA,IAAME,eAAe,SAAfA,YAAe,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AACrC,QAAIC,wEACFH,IAAII,MAAJ,CAAWC,SADb;AAEAT,WAAOO,GAAP,EACKG,IADL,CACU,UAAUC,UAAV,EAAsB;AACxB,YAAIC,SAAS,EAAb;AACA,YAAMC,IAAIX,QAAQY,IAAR,CAAaH,UAAb,CAAV;AACA,YAAMI,gBAAgBF,EAAE,cAAF,EAAkBG,IAAlB,CAAuB,GAAvB,CAAtB;AACA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,cAAcG,MAAlC,EAA0CD,GAA1C,EAA+C;AAC3C,gBAAIE,OAAO;AACPV,2BAAWL,IAAII,MAAJ,CAAWC,SADf;AAEPW,2BAAW;AAFJ,aAAX;AAIA,gBAAIC,WAAWN,cAAcE,CAAd,EAAiBI,QAAhC;AACA,gBAAIA,SAAS,CAAT,EAAYC,IAAZ,CAAiBC,OAAjB,CAAyBnB,IAAII,MAAJ,CAAWC,SAApC,IAAiD,CAAC,CAAtD,EAAyD;AACrDU,qBAAKC,SAAL,GAAiBC,SAAS,CAAT,EAAYC,IAAZ,CAAiBE,OAAjB,CAAyBpB,IAAII,MAAJ,CAAWC,SAApC,EAA+C,EAA/C,CAAjB;AACAU,qBAAKC,SAAL,GAAiBD,KAAKC,SAAL,CAAeK,IAAf,EAAjB;AACAb,uBAAOc,IAAP,CAAYP,IAAZ;AACH;AACJ;AACDd,YAAIsB,IAAJ,CAAS;AACLL,kBAAMV;AADD,SAAT;AAGH,KApBL,EAqBKgB,KArBL,CAqBW,UAAUC,GAAV,EAAe;AAClBvB,aAAK,EAACwB,OAAOD,GAAR,EAAL;AACH,KAvBL;AAwBH,CA3BD;;AA6BAE,OAAOC,OAAP,GAAiB;AACb7B,kBAAcA;AADD,CAAjB","file":"search.controller.js","sourcesContent":["/**\n * Created by swapnil on 19/02/18.\n */\n'use strict';\nconst reqPro = require('request-promise');\nconst cheerio = require('cheerio');\n\nconst searchMovies = (req, res, next) => {\n    let url = `http://www.kids-in-mind.com/cgi-bin/search/search.pl?q=\n    ${req.params.movieName}`;\n    reqPro(url)\n        .then(function (htmlString) {\n            let result = [];\n            const $ = cheerio.load(htmlString);\n            const searchResults = $('p[start=\"1\"]').find('a');\n            for (let i = 0; i < searchResults.length; i++) {\n                let temp = {\n                    movieName: req.params.movieName,\n                    kimRating: null\n                };\n                let children = searchResults[i].children;\n                if (children[0].data.indexOf(req.params.movieName) > -1) {\n                    temp.kimRating = children[0].data.replace(req.params.movieName, '');\n                    temp.kimRating = temp.kimRating.trim();\n                    result.push(temp);\n                }\n            }\n            res.json({\n                data: result\n            });\n        })\n        .catch(function (err) {\n            next({error: err});\n        });\n};\n\nmodule.exports = {\n    searchMovies: searchMovies\n};"]}