{"version":3,"sources":["../../../controllers/admin/social.controller.js"],"names":["mysqlDetails","utils","getAdminSocialDetails","req","res","next","pool","getConnection","err","connection","message","query","rows","json","data","release","updateAdminSocialDetails","mandatoryFields","checkReqBody","checkMandatoryRequestBody","body","values","socialFacebook","socialTwitter","socialID","mysqlFormat","module","exports"],"mappings":"AAAA;;;AAGA;;AAEA;;IAAYA,Y;;AACZ;;IAAYC,K;;;;AAEZ,IAAIC,wBAAwB,SAAxBA,qBAAwB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5CL,iBAAaM,IAAb,CAAkBC,aAAlB,CAAgC,UAAUC,GAAV,EAAeC,UAAf,EAA2B;AACvD,YAAID,GAAJ,EAAS;AACLH,iBAAK;AACDK,yBAASF;AADR,aAAL;AAGH,SAJD,MAIO;AACHC,uBAAWE,KAAX,CAAiB,kBAAjB,EAAqC,CAAC,sBAAD,CAArC,EACI,UAACH,GAAD,EAAMI,IAAN,EAAe;AACX,oBAAIJ,GAAJ,EAAS;AACLH,yBAAK;AACDK,iCAASF;AADR,qBAAL;AAGH,iBAJD,MAIO;AACHJ,wBAAIS,IAAJ,CAAS;AACLH,iCAAS,qCADJ;AAELI,8BAAMF,KAAK,CAAL;AAFD,qBAAT;AAIH;AACJ,aAZL;AAaH;AACDH,mBAAWM,OAAX;AACH,KArBD;AAsBH,CAvBD;;AAyBA,IAAIC,2BAA2B,SAA3BA,wBAA2B,CAACb,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC/C;AACA,QAAIY,kBAAkB,CAAC,gBAAD,EAAmB,eAAnB,EAClB,UADkB,CAAtB;AAEA,QAAIC,eAAejB,MAAMkB,yBAAN,CAAgChB,IAAIiB,IAApC,EAA0CH,eAA1C,CAAnB;AACA,QAAIC,aAAaR,OAAb,KAAyB,SAA7B,EAAwC;AACpC,eAAOL,KAAK,EAACK,SAASQ,aAAaR,OAAvB,EAAL,CAAP;AACH;;AAEDV,iBAAaM,IAAb,CAAkBC,aAAlB,CAAgC,UAAUC,GAAV,EAAeC,UAAf,EAA2B;AACvD,YAAID,GAAJ,EAAS;AACLJ,gBAAIS,IAAJ,CAASL,GAAT;AACH,SAFD,MAEO;AACH,gBAAIG,QAAQ,4DAAZ;AACA,gBAAIU,SAAS,CAAC,sBAAD,EAAyBlB,IAAIiB,IAAJ,CAASE,cAAlC,EACTnB,IAAIiB,IAAJ,CAASG,aADA,EACe,UADf,EAC2BpB,IAAIiB,IAAJ,CAASI,QADpC,CAAb;AAEAb,oBAAQX,aAAayB,WAAb,CAAyBd,KAAzB,EAAgCU,MAAhC,CAAR;AACAZ,uBAAWE,KAAX,CAAiBA,KAAjB,EAAwBU,MAAxB,EAAgC,UAAUb,GAAV,EAAeI,IAAf,EAAqB;AACjD,oBAAIJ,GAAJ,EAAS;AACLH,yBAAK;AACDK,iCAASF;AADR,qBAAL;AAGH,iBAJD,MAIO;AACHC,+BAAWE,KAAX,CAAiB,kBAAjB,EAAqC,CAAC,sBAAD,CAArC,EACI,UAACH,GAAD,EAAMI,IAAN,EAAe;AACX,4BAAIJ,GAAJ,EAAS;AACLH,iCAAK;AACDK,yCAASF;AADR,6BAAL;AAGH,yBAJD,MAIO;AACHJ,gCAAIS,IAAJ,CAAS;AACLH,yCAAS,qCADJ;AAELI,sCAAMF,KAAK,CAAL;AAFD,6BAAT;AAIH;AACJ,qBAZL;AAaH;AACJ,aApBD;AAqBH;AACDH,mBAAWM,OAAX;AACH,KA/BD;AAgCH,CAzCD;;AA2CAW,OAAOC,OAAP,GAAiB;AACbzB,2BAAuBA,qBADV;AAEbc,8BAA0BA;AAFb,CAAjB","file":"social.controller.js","sourcesContent":["/**\n * Created by swapnil on 12/02/18.\n */\n'use strict';\n\nimport * as mysqlDetails from '../../database/connectMySQL';\nimport * as utils from '../../services/utils.service';\n\nlet getAdminSocialDetails = (req, res, next) => {\n    mysqlDetails.pool.getConnection(function (err, connection) {\n        if (err) {\n            next({\n                message: err\n            });\n        } else {\n            connection.query('SELECT * FROM ??', ['admin_setting_social'],\n                (err, rows) => {\n                    if (err) {\n                        next({\n                            message: err\n                        });\n                    } else {\n                        res.json({\n                            message: 'Successfully fetched social details',\n                            data: rows[0]\n                        });\n                    }\n                });\n        }\n        connection.release();\n    });\n};\n\nlet updateAdminSocialDetails = (req, res, next) => {\n    // Check for mandatory fields\n    let mandatoryFields = ['socialFacebook', 'socialTwitter',\n        'socialID'];\n    let checkReqBody = utils.checkMandatoryRequestBody(req.body, mandatoryFields);\n    if (checkReqBody.message !== 'success') {\n        return next({message: checkReqBody.message});\n    }\n\n    mysqlDetails.pool.getConnection(function (err, connection) {\n        if (err) {\n            res.json(err);\n        } else {\n            let query = 'UPDATE ?? SET socialFacebook=?, socialTwitter=? WHERE ??=?';\n            let values = ['admin_setting_social', req.body.socialFacebook,\n                req.body.socialTwitter, 'socialID', req.body.socialID];\n            query = mysqlDetails.mysqlFormat(query, values);\n            connection.query(query, values, function (err, rows) {\n                if (err) {\n                    next({\n                        message: err\n                    });\n                } else {\n                    connection.query('SELECT * FROM ??', ['admin_setting_social'],\n                        (err, rows) => {\n                            if (err) {\n                                next({\n                                    message: err\n                                });\n                            } else {\n                                res.json({\n                                    message: 'Successfully updated social details',\n                                    data: rows[0]\n                                });\n                            }\n                        });\n                }\n            });\n        }\n        connection.release();\n    });\n};\n\nmodule.exports = {\n    getAdminSocialDetails: getAdminSocialDetails,\n    updateAdminSocialDetails: updateAdminSocialDetails\n};\n"]}