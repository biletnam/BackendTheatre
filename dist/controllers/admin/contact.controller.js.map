{"version":3,"sources":["../../../controllers/admin/contact.controller.js"],"names":["mysqlDetails","utils","getAdminContactDetails","req","res","next","pool","getConnection","err","connection","message","query","rows","json","data","release","updateAdminContactDetails","mandatoryFields","checkReqBody","checkMandatoryRequestBody","body","values","contactName","contactEmail","contactPhone","contactID","mysqlFormat","module","exports"],"mappings":"AAAA;;;AAGA;;AAEA;;IAAYA,Y;;AACZ;;IAAYC,K;;;;AAEZ,IAAIC,yBAAyB,SAAzBA,sBAAyB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC7CL,iBAAaM,IAAb,CAAkBC,aAAlB,CAAgC,UAAUC,GAAV,EAAeC,UAAf,EAA2B;AACvD,YAAID,GAAJ,EAAS;AACLH,iBAAK;AACDK,yBAASF;AADR,aAAL;AAGH,SAJD,MAIO;AACHC,uBAAWE,KAAX,CAAiB,kBAAjB,EAAqC,CAAC,uBAAD,CAArC,EACI,UAACH,GAAD,EAAMI,IAAN,EAAe;AACX,oBAAIJ,GAAJ,EAAS;AACLH,yBAAK;AACDK,iCAASF;AADR,qBAAL;AAGH,iBAJD,MAIO;AACHJ,wBAAIS,IAAJ,CAAS;AACLH,iCAAS,sCADJ;AAELI,8BAAMF,KAAK,CAAL;AAFD,qBAAT;AAIH;AACJ,aAZL;AAaH;AACDH,mBAAWM,OAAX;AACH,KArBD;AAsBH,CAvBD;;AAyBA,IAAIC,4BAA4B,SAA5BA,yBAA4B,CAACb,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAChD;AACA,QAAIY,kBAAkB,CAAC,aAAD,EAAgB,cAAhB,EAAgC,cAAhC,EAAgD,WAAhD,CAAtB;AACA,QAAIC,eAAejB,MAAMkB,yBAAN,CAAgChB,IAAIiB,IAApC,EAA0CH,eAA1C,CAAnB;AACA,QAAIC,aAAaR,OAAb,KAAyB,SAA7B,EAAwC;AACpC,eAAOL,KAAK,EAACK,SAASQ,aAAaR,OAAvB,EAAL,CAAP;AACH;;AAEDV,iBAAaM,IAAb,CAAkBC,aAAlB,CAAgC,UAAUC,GAAV,EAAeC,UAAf,EAA2B;AACvD,YAAID,GAAJ,EAAS;AACLJ,gBAAIS,IAAJ,CAASL,GAAT;AACH,SAFD,MAEO;AACH,gBAAIG,QAAQ,gEACR,aADJ;AAEA,gBAAIU,SAAS,CAAC,uBAAD,EAA0BlB,IAAIiB,IAAJ,CAASE,WAAnC,EACTnB,IAAIiB,IAAJ,CAASG,YADA,EACcpB,IAAIiB,IAAJ,CAASI,YADvB,EACqC,WADrC,EAETrB,IAAIiB,IAAJ,CAASK,SAFA,CAAb;AAIAd,oBAAQX,aAAa0B,WAAb,CAAyBf,KAAzB,EAAgCU,MAAhC,CAAR;AACAZ,uBAAWE,KAAX,CAAiBA,KAAjB,EAAwBU,MAAxB,EAAgC,UAAUb,GAAV,EAAeI,IAAf,EAAqB;AACjD,oBAAIJ,GAAJ,EAAS;AACLH,yBAAK;AACDK,iCAASF;AADR,qBAAL;AAGH,iBAJD,MAIO;AACHC,+BAAWE,KAAX,CAAiB,kBAAjB,EAAqC,CAAC,uBAAD,CAArC,EACI,UAACH,GAAD,EAAMI,IAAN,EAAe;AACf,4BAAIJ,GAAJ,EAAS;AACLH,iCAAK;AACDK,yCAASF;AADR,6BAAL;AAGH,yBAJD,MAIO;AACHJ,gCAAIS,IAAJ,CAAS;AACLH,yCAAS,sCADJ;AAELI,sCAAMF,KAAK,CAAL;AAFD,6BAAT;AAIH;AACJ,qBAZD;AAaH;AACJ,aApBD;AAqBH;AACDH,mBAAWM,OAAX;AACH,KAlCD;AAmCH,CA3CD;;AA6CAY,OAAOC,OAAP,GAAiB;AACb1B,4BAAwBA,sBADX;AAEbc,+BAA2BA;AAFd,CAAjB","file":"contact.controller.js","sourcesContent":["/**\n * Created by swapnil on 12/02/18.\n */\n'use strict';\n\nimport * as mysqlDetails from '../../database/connectMySQL';\nimport * as utils from '../../services/utils.service';\n\nlet getAdminContactDetails = (req, res, next) => {\n    mysqlDetails.pool.getConnection(function (err, connection) {\n        if (err) {\n            next({\n                message: err\n            });\n        } else {\n            connection.query('SELECT * FROM ??', ['admin_setting_contact'],\n                (err, rows) => {\n                    if (err) {\n                        next({\n                            message: err\n                        });\n                    } else {\n                        res.json({\n                            message: 'Successfully fetched contact details',\n                            data: rows[0]\n                        });\n                    }\n                });\n        }\n        connection.release();\n    });\n};\n\nlet updateAdminContactDetails = (req, res, next) => {\n    // Check for mandatory fields\n    let mandatoryFields = ['contactName', 'contactEmail', 'contactPhone', 'contactID'];\n    let checkReqBody = utils.checkMandatoryRequestBody(req.body, mandatoryFields);\n    if (checkReqBody.message !== 'success') {\n        return next({message: checkReqBody.message});\n    }\n\n    mysqlDetails.pool.getConnection(function (err, connection) {\n        if (err) {\n            res.json(err);\n        } else {\n            let query = 'UPDATE ?? SET contactName=?, contactEmail=?, contactPhone=?' +\n                ' WHERE ??=?';\n            let values = ['admin_setting_contact', req.body.contactName,\n                req.body.contactEmail, req.body.contactPhone, 'contactID',\n                req.body.contactID\n            ];\n            query = mysqlDetails.mysqlFormat(query, values);\n            connection.query(query, values, function (err, rows) {\n                if (err) {\n                    next({\n                        message: err\n                    });\n                } else {\n                    connection.query('SELECT * FROM ??', ['admin_setting_contact'],\n                        (err, rows) => {\n                        if (err) {\n                            next({\n                                message: err\n                            });\n                        } else {\n                            res.json({\n                                message: 'Successfully updated contact details',\n                                data: rows[0]\n                            });\n                        }\n                    });\n                }\n            });\n        }\n        connection.release();\n    });\n};\n\nmodule.exports = {\n    getAdminContactDetails: getAdminContactDetails,\n    updateAdminContactDetails: updateAdminContactDetails\n};\n"]}